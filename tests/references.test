# -*- tcl -*- tcl.tk//DSL tcltest//EN//2.0
## (c) 2021 Andreas Kupries
# # ## ### ##### ######## ############# #####################
## Ankh testsuite
## - API testing
#
## ak hash HASH references

kt check Tcl     8.5
kt check tcltest 2

kt local testing ankh

# # ## ### ##### ######## ############# #####################

foreach {hash references} {
    md4  {https://en.wikipedia.org/wiki/MD4}
    md5  {https://en.wikipedia.org/wiki/MD5}
    sha1 {https://en.wikipedia.org/wiki/SHA-1}
    sha2 {https://en.wikipedia.org/wiki/SHA-2}
    sha3 {https://en.wikipedia.org/wiki/SHA-3 http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf https://github.com/brainhub/SHA3IUF MIT}
} {
    tcltest::test ankh-${hash}-references-1.0 "ak hash $hash references, wrong#args" -body {
	ak hash $hash references X
    } -returnCodes error -result "wrong # args: should be \"ak hash $hash references\""

    # - -- --- ----- -------- ------------- ---------------------

    tcltest::test ankh-${hash}-references-2.0 "ak hash $hash references" -body {
	ak hash $hash references
    } -result $references
}

# # ## ### ##### ######## ############# #####################
cleanupTests
return
